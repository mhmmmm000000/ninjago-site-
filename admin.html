<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Admin Panel â€” Ninjago Marketplace</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{
  --bg:#071428; --card:#0b1520; --muted:#9aa4b2; --accent:#f1c40f;
  --text:#e7eef7; --danger:#ef4444; --good:#22c55e;
}
body{
  margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
  background:var(--bg); color:var(--text); padding:20px;
}
h2{margin-top:0}
.card{
  background:var(--card); padding:16px; border-radius:12px;
  margin-bottom:16px; border:1px solid rgba(255,255,255,0.05);
}
button{
  padding:8px 12px; border-radius:8px; border:0; cursor:pointer;
  font-weight:700; margin-right:6px;
}
.btn-danger{ background:var(--danger); color:white; }
.btn{ background:#123; color:#dff3ff; }
input[type=password]{
  width:260px; padding:8px 12px; border-radius:8px; border:1px solid #333;
  background:#0e1a24; color:var(--text); font-size:16px;
}
table{width:100%;border-collapse:collapse;margin-top:10px}
td,th{padding:10px;border-bottom:1px solid rgba(255,255,255,0.08)}
th{text-align:left;background:#0f1c26}
.meta{color:var(--muted);font-size:13px}
.center{display:flex;flex-direction:column;align-items:center;margin-top:120px}
.success{color:var(--good);margin-top:10px}
</style>
</head>
<body>

<div id="authScreen" class="center">
  <h2>Admin Login</h2>
  <input id="adminPass" type="password" placeholder="Enter admin password">
  <button id="loginBtn" class="btn">Login</button>
  <div id="loginMsg" class="meta"></div>
</div>

<div id="adminPanel" style="display:none">
  <h2>ðŸ“¦ Orders</h2>
  <div id="ordersArea"></div>

  <h2>ðŸ’¬ Requests</h2>
  <div id="reqArea"></div>
</div>

<script>
// password gate
const PASSWORD = "M.O.D8643";

const authScreen = document.getElementById('authScreen');
const adminPanel = document.getElementById('adminPanel');
const loginMsg = document.getElementById('loginMsg');

document.getElementById('loginBtn').onclick = () => {
  const pass = document.getElementById('adminPass').value.trim();
  if(pass === PASSWORD){
    authScreen.style.display = "none";
    adminPanel.style.display = "block";
    loadOrders();
    loadRequests();
  } else {
    loginMsg.textContent = "Incorrect password";
  }
};

// load orders
function loadOrders(){
  const orders = JSON.parse(localStorage.getItem('orders')||'[]');
  const area = document.getElementById('ordersArea');
  if(!orders.length){
    area.innerHTML = `<p class="meta">No orders yet.</p>`;
    return;
  }
  area.innerHTML = `
    <button onclick="clearOrders()" class="btn-danger">Clear all orders</button>
    <table>
      <tr><th>ID</th><th>Name</th><th>Total</th><th>Method</th><th>Actions</th></tr>
      ${orders.map(o=>`
        <tr>
          <td>${o.id}</td>
          <td>${o.name || "(no name)"}</td>
          <td>SAR ${o.total}</td>
          <td>${o.method}</td>
          <td>
            <button class="btn" onclick="viewOrder('${o.id}')">View</button>
            <button class="btn-danger" onclick="deleteOrder('${o.id}')">Delete</button>
          </td>
        </tr>
      `).join("")}
    </table>
  `;
}

function deleteOrder(id){
  let orders = JSON.parse(localStorage.getItem('orders')||'[]');
  orders = orders.filter(o=>o.id !== id);
  localStorage.setItem('orders', JSON.stringify(orders));
  loadOrders();
}

function clearOrders(){
  if(confirm("Clear ALL orders?")) {
    localStorage.removeItem('orders');
    loadOrders();
  }
}

function viewOrder(id){
  const orders = JSON.parse(localStorage.getItem('orders')||'[]');
  const o = orders.find(x=>x.id===id);
  if(!o) return;

  let msg = `ORDER ID: ${o.id}\nTotal: SAR ${o.total}\nMethod: ${o.method}\n`;

  if(o.name) msg += `Customer: ${o.name}\n`;
  if(o.email) msg += `Email: ${o.email}\n`;
  if(o.date) msg += `Pickup: ${o.date}\n`;
  if(o.msg) msg += `Notes: ${o.msg}\n`;

  msg += "\nItems:\n";
  o.cart.forEach(i=>{
    msg += `- ${i.title} x${i.qty} (SAR ${i.price})\n`;
  });

  alert(msg);
}

// requests
function loadRequests(){
  const reqs = JSON.parse(localStorage.getItem('requests')||'[]');
  const area = document.getElementById('reqArea');
  if(!reqs.length){
    area.innerHTML = `<p class="meta">No requests yet.</p>`;
    return;
  }
  area.innerHTML = `
    <button onclick="clearReqs()" class="btn-danger">Clear all</button>
    <table>
      <tr><th>From</th><th>Message</th><th>Actions</th></tr>
      ${reqs.map((r,i)=>`
        <tr>
          <td>${r.from}</td>
          <td>${r.text}</td>
          <td><button class="btn-danger" onclick="delReq(${i})">Delete</button></td>
        </tr>
      `).join("")}
    </table>
  `;
}
function clearReqs(){
  if(confirm("Delete ALL requests?")) {
    localStorage.removeItem('requests');
    loadRequests();
  }
}
function delReq(i){
  let arr = JSON.parse(localStorage.getItem('requests')||'[]');
  arr.splice(i,1);
  localStorage.setItem('requests', JSON.stringify(arr));
  loadRequests();
}
</script>

</body>
</html>
