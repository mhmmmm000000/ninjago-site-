<!doctype html>
<html lang="en">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Admin — Ninjago Market</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="container">
    <h1>Admin</h1>
    <div id="adminArea"></div>
  </main>

<script>
const ADMIN_PASS = 'M.O.D8643'; // you requested this password be in the file
function showLogin(){
  document.getElementById('adminArea').innerHTML = `
    <div style="max-width:420px"><input id="apass" class="input" placeholder="Admin password"><div style="margin-top:8px"><button id="alogin" class="btn">Unlock</button></div></div>
  `;
  document.getElementById('alogin').onclick = ()=> {
    const v = document.getElementById('apass').value;
    if(v === ADMIN_PASS){ showAdminUI(); } else { alert('Wrong password'); }
  };
}
function showAdminUI(){
  const orders = JSON.parse(localStorage.getItem('nm_orders')||'[]');
  const data = JSON.parse(localStorage.getItem('nm_products')|| localStorage.getItem('products_json') || 'null');
  const prods = data || 'local products.json (read-only)';
  document.getElementById('adminArea').innerHTML = `
    <div style="display:flex;gap:12px;flex-direction:column">
      <div><h3>Orders (${orders.length})</h3><div>${orders.map(o=>`<div style="border:1px solid #ddd;margin-bottom:8px;padding:8px"><strong>${o.id}</strong> — ${o.user} — ${o.method} — SAR ${o.total}<div class="meta">${new Date(o.created).toLocaleString()}</div></div>`).join('') || '<div class="meta">No orders</div>'}</div></div>
      <div><h3>Feedback</h3><div>${(JSON.parse(localStorage.getItem('nm_feedback')||'[]')).map(f=>`<div style="border:1px solid #ddd;padding:8px;margin-bottom:8px">${f.text}<div class="meta">by ${f.email||'guest'}</div></div>`).join('') || '<div class="meta">No feedback</div>'}</div></div>
      <div><h3>Giftcards (create)</h3>
        <input id="gcCode" class="input" placeholder="Code (e.g. GC-1)"><input id="gcBal" class="input" placeholder="Balance (SAR)" type="number">
        <button id="gcCreate" class="btn small">Create</button>
        <div id="gclist"></div>
      </div>
    </div>
  `;
  document.getElementById('gcCreate').onclick = ()=>{
    const code = document.getElementById('gcCode').value.trim();
    const bal = Number(document.getElementById('gcBal').value) || 0;
    if(!code){ alert('Enter code'); return; }
    const arr = JSON.parse(localStorage.getItem('nm_giftcards')||'[]');
    arr.push({code, balance: bal});
    localStorage.setItem('nm_giftcards', JSON.stringify(arr));
    renderGiftList();
  };
  function renderGiftList(){ const arr = JSON.parse(localStorage.getItem('nm_giftcards')||'[]'); document.getElementById('gclist').innerHTML = arr.map(g=>`<div>${g.code} — SAR ${g.balance.toFixed(2)}</div>`).join('') || '<div class="meta">No cards</div>'; }
  renderGiftList();
}

showLogin();
</script>
</body>
</html>
