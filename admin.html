<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin — Ninjago Marketplace (Demo)</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="site-header">
    <div class="logo">Admin — Ninjago Marketplace</div>
    <div><button id="btnLogout" class="btn small">Logout</button></div>
  </header>

  <main class="container">
    <div id="loginArea">
      <h2>Admin login</h2>
      <p>Enter admin password</p>
      <input id="adminPass" class="input" placeholder="Password">
      <div style="margin-top:8px">
        <button id="btnLogin" class="btn">Login</button>
      </div>
      <p class="hint">(This demo uses client-side password. Password: M.O.D8643)</p>
    </div>

    <div id="adminArea" style="display:none">
      <h2>Orders</h2>
      <div id="ordersList"></div>
      <h2>Requests</h2>
      <div id="requestsList"></div>
      <h2>Points</h2>
      <div id="pointsList"></div>
    </div>
  </main>

<script>
const ADMIN_PASSWORD = 'M.O.D8643';
document.getElementById('btnLogin').onclick = ()=>{
  const p = document.getElementById('adminPass').value.trim();
  if(p === ADMIN_PASSWORD){
    document.getElementById('loginArea').style.display = 'none';
    document.getElementById('adminArea').style.display = '';
    loadData();
  } else alert('Wrong password');
};
document.getElementById('btnLogout').onclick = ()=> { document.getElementById('loginArea').style.display=''; document.getElementById('adminArea').style.display='none'; };

function loadData(){
  const orders = JSON.parse(localStorage.getItem('orders_all') || '[]');
  const reqs = JSON.parse(localStorage.getItem('requests') || '[]');
  const ordersList = document.getElementById('ordersList');
  ordersList.innerHTML = orders.length ? orders.map(o=>`<div style="border:1px solid rgba(0,0,0,0.06);padding:8px;border-radius:6px;margin-bottom:8px"><strong>${o.id}</strong> — ${o.email} — ${o.method} — SAR ${o.total}<div class="meta">Items: ${o.items ? o.items.map(i=>i.title).join(', ') : ''}</div></div>`).join('') : '<div class="meta">No orders</div>';
  const requestsList = document.getElementById('requestsList');
  requestsList.innerHTML = reqs.length ? reqs.map(r=>`<div class="req-item">${r.time?new Date(r.time).toLocaleString() : ''} — ${r.text}</div>`).join('') : '<div class="meta">No requests</div>';

  // show points (scan localStorage keys)
  const points = [];
  for(let i=0;i<localStorage.length;i++){
    const k = localStorage.key(i);
    if(k && k.startsWith('points_')) points.push({ email: k.replace('points_',''), points: Number(localStorage.getItem(k)) });
  }
  const pointsList = document.getElementById('pointsList');
  pointsList.innerHTML = points.length ? points.map(p=>`<div>${p.email} — ${p.points} points</div>`).join('') : '<div class="meta">No points yet</div>';
}
</script>
</body>
</html>
